---
title: Python Excel 操作 | xlrd 模块笔记
type: post
topic/tags: ["others", "编程"]
date: 2020-02-18T08:06:39.000Z
category: 编程
published: true
---



## 1. Excel 文件处理

- 打开 excel 文件

```python
excel = xlrd.open_workbook("data.xlsx")  
```


- 获取并操作 sheet 工作表

```python
sheets = excel.sheet_names()  # 获取工作表 sheet 名称数组, ['Sheet1', 'Sheet2', 'Sheet3']
sheet = excel.sheet_by_index(0) #根据下标获取对应的 sheet 表

sheet.row_values(0) #获取第一行的数据
sheet.col_values(0) #获取第一列的数据
sheet.nrows         #获取总共的行数
sheet.ncols         #获取总共的列数
```


- 遍历所有行

```python
for i in range(0, sheet.nrows):
    row_list = sheet.row_values(i) # 每一行的数据在row_list 数组里
```## 2. 日期处理

```python
import datetime
from xlrd import xldate_as_datetime

xldate_as_datetime(43346.0, 0).strftime('%Y/%m/%d') 
# '2018/09/03'
```

