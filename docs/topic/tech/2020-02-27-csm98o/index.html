<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="../../../fonts/academicons-1.8.6/css/academicons.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../../img/logo.png"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    
    
    
    <title>R 语言画图中英文字体解决方案 - Steven Shen | 沈维燕</title> 
    <meta property="og:title" content="R 语言画图中英文字体解决方案 - Steven Shen | 沈维燕">
    

    
      
    

    

    
  
    <link rel="stylesheet" href="https://shen.bioitee.com/css/style.css"/>
    <link rel="stylesheet" href="https://shen.bioitee.com/css/fonts.css"/>
    

<link rel="stylesheet" href="https://shen.bioitee.com/css/custom.css" />

  </head>

  
  <body class="topic">
    
    
    <header class="intro-and-nav" role="banner">
    <div>
      <div class="intro">
        <a class="logo" href="../../../" aria-label="Steven Shen | 沈维燕 home page">
          <img src="https://shen.bioitee.com/img/logo.png" alt="">
        </a>
        <p class="library-desc">
          
            Welcome to the blog site of Steven Shen.
          
        </p>
      </div>
      <nav id="patterns-nav" class="patterns" role="navigation">
        <h2 class="vh">Main navigation</h2>
        <button id="menu-button" aria-expanded="false">
          
          Menu
        </button>
        
        <ul id="patterns-list">
          
          <li class="pattern">
          
          
          
            <a href="../../../" >
              
              首页
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="../../../about/" >
              
              关于
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="../../../articles/" >
              
              博文
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="https://apps-db.oss-cn-shenzhen.aliyuncs.com/bioitee/bioitee.png" >
              
              彩蛋
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="https://www.yuque.com/shenweiyan" >
              
              语雀
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="../../../feedback/" >
              
              留言
            </a>
          </li>
          
          

<li class="pattern">&nbsp;&nbsp;</li>



<li class="pattern"><a href="https://github.com/shenweiyan/shen.bioitee.com/edit/master/content/topic/tech/2020-02-27-csm98o.md" target="_blank">编辑</a></li>


<li class="pattern"><a href="../../../topic/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li class="pattern"><a href="../../../declare/" title="声明">声明</a></li>


        </ul>
      </nav>
    </div>
    </header>

    <article class="main">
      <header class="title">
      
  



<h1>R 语言画图中英文字体解决方案</h1>






<h3>沈维燕 &middot 
2020-02-27</h3> 


   
  



      </header>


  
  
  

  
  
  

  <p>在某些时候，需要在 R 画图中添加中文，但是默认情况下，R 对中文的支持不好。这里推荐一个 <code>showtext</code> 的 R 包。如果需要将含有中文字体的图形保存为 pdf 文件，可以使用下面讲到的方案，最新版的 <code>showtext</code> 已经支持了 <code>ggplot2</code>，推荐使用此种方案。</p>

<p><strong>这样，在你写的 R 代码中，开头添加：</strong></p>

<pre><code class="language-r">library(showtext)
showtext_auto(enable=True)	# 表示之后用上同样的字体
font_add(&quot;kaishu&quot;, &quot;simkai.ttf&quot;) # 如果系统已经安装了该字体，可以通过这种方式调用
font_add('SimSun', regular = '/Library/Fonts/Microsoft/SimSun.ttf') #添加字体, 必须给定指定的字体的位置
</code></pre>

<ul>
<li><strong>如果你使用的是 MAC，可以打开 font book，查找你想要字体的位置。如 SimSun：/Library/Fonts/Microsoft/SimSun.ttf</strong>。</li>
<li><strong>如果你使用的是 Linux，字体应该位于 <code>/usr/share/fonts</code>  目录下。</strong></li>
</ul>

<p><strong>来一个示例，示例的各个函数解释后面有：</strong></p>

<p><strong><img src="https://note.bioitee.com/yuque/0/2020/png/126032/1582790366836-0fe8ed2e-b492-40b6-9f7f-e5041622f202.png#align=left&amp;display=inline&amp;height=98&amp;name=image.png&amp;originHeight=98&amp;originWidth=651&amp;size=13273&amp;status=done&amp;style=none&amp;width=651" alt="" /></strong></p>

<pre><code class="language-r">library(showtext)
showtext_auto(enable=True)
font_add('SimSun', &quot;simsun.ttc&quot;)
         
set.seed(123)

## For now we are using a device functions to draw axis labels
plot(1, xlim = c(-3, 3), ylim = c(-3, 3), type = &quot;n&quot;)

## Then turn showtext on and draw some characters
showtext_begin()

text(runif(100, -3, 3), runif(100, -3, 3), 
     intToUtf8(round(runif(100, 20200, 30000)), multiple=TRUE), 
     col=rgb(runif(100), runif(100), runif(100), 0.5 + runif(100)/2), 
     cex=2, family=&quot;SimSun&quot;)

title(&quot;随机汉字&quot;, family=&quot;SimSun&quot;)

showtext_end()
</code></pre>

<pre><code class="language-r">&gt; sessionInfo()
R version 3.6.2 (2019-12-12)
Platform: x86_64-conda_cos6-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/local/software/miniconda3/lib/libopenblasp-r0.3.7.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] showtext_0.7   showtextdb_2.0 sysfonts_0.8

loaded via a namespace (and not attached):
[1] compiler_3.6.2
</code></pre>

<p><a data-fancybox="gallery" href="https://note.bioitee.com/yuque/0/2020/png/126032/1582790619719-5c33f032-7a98-4c4d-90db-79bdc71420df.png#align=left&amp;display=inline&amp;height=710&amp;name=image.png&amp;originHeight=710&amp;originWidth=688&amp;size=164420&amp;status=done&amp;style=none&amp;width=688"><img src="https://note.bioitee.com/yuque/0/2020/png/126032/1582790619719-5c33f032-7a98-4c4d-90db-79bdc71420df.png#align=left&amp;display=inline&amp;height=710&amp;name=image.png&amp;originHeight=710&amp;originWidth=688&amp;size=164420&amp;status=done&amp;style=none&amp;width=688" alt=""></a></p>

<p><strong>runif() 是 R 语言生成均匀分布随机数的函数，句法是：runif(n, min=0, max=1)，其中 n 表示生成的随机数数量，min 表示均匀分布的下限，max 表示均匀分布的上限；若省略参数 min、max，则默认生成 [0,1] 上的均匀分布随机数。例子如下：</strong></p>

<pre><code class="language-r">&gt; runif(5, 0, 1)     # 生成5个[0,1]的均匀分布的随机数
[1] 0.5993 0.7391 0.2617 0.5077 0.7199 

&gt; runif(5)           # 默认生成5个[0,1]上的均匀分布随机数
[1] 0.2784 0.7755 0.4107 0.8392 0.7455
</code></pre>

<p><strong>round 是 R 语言里的 “四舍五入” 的函数，具体的规则采用 banker&rsquo;s rounding，即四舍六入五留双规则(<a href="http://zh.wikipedia.org/wiki/%E6%95%B8%E5%80%BC%E4%BF%AE%E7%B4%84%E8%A6%8F%E5%89%87">wiki</a>)。round 的原型是 round(x, digits = 0)，digits 用于设定小数点位置，默认为零即小数点后零位（取整）。例子如下：</strong></p>

<pre><code class="language-r">&gt; c &lt;- c(1.4, 1.6, 1.5, 2.5, 2.51)
&gt; round(c)
[1] 1 2 2 2 3
</code></pre>

<p><strong>intToUtf8 是一个将整数向量转换为或转换为 Utf-8 编码字符向量的函数，与之对应的函数是 utf8ToInt —— 一个能把 Utf-8 编码字符转换为整数向量的函数。示例如下：</strong></p>

<pre><code class="language-r">&gt; utf8ToInt(&quot;沈维燕&quot;)
[1] 27784 32500 29141
&gt; intToUtf8(c(27784, 32500,29141))
[1] &quot;沈维燕&quot;
&gt; intToUtf8(c(27784, 32500,29141), multiple=TRUE)	# multiple: 转换为单个字符串还是多个单独的字符
[1] &quot;沈&quot; &quot;维&quot; &quot;燕&quot;
</code></pre>

<p><a data-fancybox="gallery" href="https://note.bioitee.com/yuque/0/2020/gif/126032/1582868512420-823f0c0a-1af9-48eb-bd15-a7d89f3e60e0.gif#align=left&amp;display=inline&amp;height=157&amp;name=comment.gif&amp;originHeight=157&amp;originWidth=164&amp;size=29605&amp;status=done&amp;style=none&amp;width=164"><img src="https://note.bioitee.com/yuque/0/2020/gif/126032/1582868512420-823f0c0a-1af9-48eb-bd15-a7d89f3e60e0.gif#align=left&amp;display=inline&amp;height=157&amp;name=comment.gif&amp;originHeight=157&amp;originWidth=164&amp;size=29605&amp;status=done&amp;style=none&amp;width=164" alt="comment.gif"></a></p>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">
      
      <a href="../../../topic/tech/2020-02-21-tar-issues-note/">tar 打包的一些注意问题</a>
      <br/>&larr;&nbsp;
      
  </span>
  <span class="nav-next">
      
  </span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/topic\/tech\/2020-02-21-tar-issues-note\/';
    
  } else if (e.which == 39) {  
    
  }
  if (url) window.location = url;
});
</script>



<section class="comments">
<script src="https://utteranc.es/client.js"
        repo="shenweiyan/issues"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</section>




<script async src="../../../js/fix-toc.js"></script>

<script async src="../../../js/center-img.js"></script>

<script async src="../../../js/right-quote.js"></script>

<script async src="../../../js/no-highlight.js"></script>

<script async src="../../../js/fix-footnote.js"></script>

<script async src="../../../js/math-code.js"></script>

<script async src="../../../js/external-link.js"></script>

<script async src="../../../js/alt-title.js"></script>

<script async src="../../../js/header-link.js"></script>

<script async src="../../../js/dom-scripts.js"></script>


<script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>



  
  
  
  

  <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5m6pzaeh5ar&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=0" async="async"></script>
  </footer>
  </article>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  </body>
</html>

