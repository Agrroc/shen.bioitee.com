<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="../../../fonts/academicons-1.8.6/css/academicons.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../../img/logo.png"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    
    
    
    
    <title>基于 gulp 的 fancybox 源码压缩 - Steven Shen | 沈维燕</title> 
    <meta property="og:title" content="基于 gulp 的 fancybox 源码压缩 - Steven Shen | 沈维燕">
    

    
      
    

    

    
  
    <link rel="stylesheet" href="https://shen.bioitee.com/css/style.css"/>
    <link rel="stylesheet" href="https://shen.bioitee.com/css/fonts.css"/>
    

<link rel="stylesheet" href="https://shen.bioitee.com/css/custom.css" />

  </head>

  
  <body class="topic">
    
    
    <header class="intro-and-nav" role="banner">
    <div>
      <div class="intro">
        <a class="logo" href="../../../" aria-label="Steven Shen | 沈维燕 home page">
          <img src="https://shen.bioitee.com/img/logo.png" alt="">
        </a>
        <p class="library-desc">
          
            Welcome to the blog site of Steven Shen.
          
        </p>
      </div>
      <nav id="patterns-nav" class="patterns" role="navigation">
        <h2 class="vh">Main navigation</h2>
        <button id="menu-button" aria-expanded="false">
          
          Menu
        </button>
        
        <ul id="patterns-list">
          
          <li class="pattern">
          
          
          
            <a href="../../../" >
              
              首页
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="../../../about/" >
              
              关于
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="../../../articles/" >
              
              博文
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="https://apps-db.oss-cn-shenzhen.aliyuncs.com/bioitee/bioitee.png" >
              
              彩蛋
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="https://www.yuque.com/shenweiyan" >
              
              语雀
            </a>
          </li>
          
          <li class="pattern">
          
          
          
            <a href="../../../feedback/" >
              
              留言
            </a>
          </li>
          
          

<li class="pattern">&nbsp;&nbsp;</li>



<li class="pattern"><a href="https://github.com/shenweiyan/shen.bioitee.com/edit/master/content/topic/tech/2019-12-26-gulp-for-fancybox.md" target="_blank">编辑</a></li>


<li class="pattern"><a href="../../../topic/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li class="pattern"><a href="../../../declare/" title="声明">声明</a></li>


        </ul>
      </nav>
    </div>
    </header>

    <article class="main">
      <header class="title">
      
  



<h1>基于 gulp 的 fancybox 源码压缩</h1>






<h3>沈维燕 &middot 
2019-12-26</h3> 


   
  



      </header>


  
  
  

  
  
  

  

<p>前不久，处理生信分析网页版自动化报告的时候就使用过 fancybox，今天在优化个人博客，为博文增加图片缩放效果，解决一些滚动条问题时，才从 fancybox 的 Github 源码中接触到 gulp —— 一个基于流的前端自动化构建工具，记录一下学习的过程。</p>

<h2 id="1-fancybox-简单介绍">1. fancybox 简单介绍</h2>

<p>关于 fancybox，其官网的介绍是：JavaScript lightbox library for presenting various types of media. Responsive, touch-enabled and customizable. 翻译过来就是，Fancybox 是一个 JavaScript 库，用于以优雅的方式呈现图像，视频和任何 HTML 内容。它具有您期望的所有功能——触摸启用，响应和完全可定制。我们来看一下 fancybox 官网提供的 demo 效果。</p>

<p><a data-fancybox="gallery" href="https://note.bioitee.com/yuque/0/2019/gif/126032/1577342995252-03959fe5-5bd2-4584-b37a-e50091119cf7.gif#align=left&amp;display=inline&amp;height=240&amp;name=fancybox-demo-86.gif&amp;originHeight=240&amp;originWidth=320&amp;size=8977538&amp;status=done&amp;style=none&amp;width=320"><img src="https://note.bioitee.com/yuque/0/2019/gif/126032/1577342995252-03959fe5-5bd2-4584-b37a-e50091119cf7.gif#align=left&amp;display=inline&amp;height=240&amp;name=fancybox-demo-86.gif&amp;originHeight=240&amp;originWidth=320&amp;size=8977538&amp;status=done&amp;style=none&amp;width=320" alt="fancybox-demo-86.gif"></a></p>

<h2 id="2-fancybox-的安装使用">2. fancybox 的安装使用</h2>

<p>我们这里所说的 fancybox，主要指的是它的 3.x 版本（即 fancybox3），网络上还有不少 1.x、2.x 的版本，我们不讨论。fancybox3 的使用很简单，只需要简单的 2 步。</p>

<ol>
<li>引入 jQuery 和 fancybox 样式文件</li>
</ol>

<pre><code class="language-html">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js&quot;&gt;&lt;/script&gt;

&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css&quot; /&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js&quot;&gt;&lt;/script&gt;
</code></pre>

<ol>
<li>创建图像链接</li>
</ol>

<pre><code class="language-html">&lt;a data-fancybox=&quot;gallery&quot; href=&quot;big_1.jpg&quot;&gt;&lt;img src=&quot;small_1.jpg&quot;&gt;&lt;/a&gt;
&lt;a data-fancybox=&quot;gallery&quot; href=&quot;big_2.jpg&quot;&gt;&lt;img src=&quot;small_2.jpg&quot;&gt;&lt;/a&gt;
</code></pre>

<h2 id="3-fancybox-的一些问题">3. fancybox 的一些问题</h2>

<p>在网上看到部分网友说，fancybox3 在打开或关闭遮罩层的时候，页面会自动返回顶部的 bug，目前我使用的 fancybox@3.5.7 暂时没发现这个问题。</p>

<p>我在这里想说一下，关于 fancybox3 隐藏页面滚动条的事情，因为 fancybox3 默认的配置项是 <code>hideScrollbar: true</code>，即默认隐藏滚动条。当然，我们可以直接修改样式也可以达到显示和隐藏滚动条的目的；或者可以在 fancybox3 的源码中设置 hideScrollbar 选项为 false，就可以出现滚动条了。</p>

<ul>
<li><p>直接修改样式</p>

<pre><code class="language-css">.fancybox-active{
overflow:hidden; 
}
</code></pre></li>

<li><p>修改源码设置</p></li>
</ul>

<p>fancybox 是基于 GPLv3 进行源码开放的，它的源吗托管在 github 上，我们可以直接在 <code>fancybox/dist/jquery.fancybox.js</code> 源码中把 <code>hideScrollbar: true</code>，更改成 <code>hideScrollbar: false</code>，然后把修改后的 <code>jquery.fancybox.js</code> 应用到你的图片页面，以达到显示滚动条的效果。</p>

<p>细心的童鞋可能发现了，fancybox 默认使用的 js 文件是 <code>jquery.fancybox.min.js</code> ，相比源码文件 <code>jquery.fancybox.js</code>  多了一个 <strong>min</strong> 后缀！所以，我们怎么才能把 <code>jquery.fancybox.js</code>  变成 <code>jquery.fancybox.min.js</code> ？</p>

<h2 id="4-gulp-简单介绍">4. Gulp 简单介绍</h2>

<p>Gulp 在官网的 title 是：用自动化构建工具增强你的工作流程，即一款基于流的前端自动化构建工具<strong>。</strong>作为前端的菜鸟，第一次听到这样的描述，是不是跟小编一样满头雾水？那么，下面摘录 segmentfault 前端分享专栏中《<a href="https://segmentfault.com/a/1190000007137199">gulp前端构建工具白话讲解，也包含自己使用的一些心得体</a>》的一些回答，让大家直观了解一下。</p>

<blockquote>
<p><a data-fancybox="gallery" href="https://note.bioitee.com/yuque/0/2019/png/126032/1577327983661-70fafa53-8c51-4dc9-b005-9c3da4924558.png#align=left&amp;display=inline&amp;height=131&amp;name=image.png&amp;originHeight=131&amp;originWidth=474&amp;size=49158&amp;status=done&amp;style=none&amp;width=474"><img src="https://note.bioitee.com/yuque/0/2019/png/126032/1577327983661-70fafa53-8c51-4dc9-b005-9c3da4924558.png#align=left&amp;display=inline&amp;height=131&amp;name=image.png&amp;originHeight=131&amp;originWidth=474&amp;size=49158&amp;status=done&amp;style=none&amp;width=474" alt=""></a></p>

<p>大家现在看到的这个图片是我使用 gulp 的一个基本的项目结构，而这边的 src 文件就是我们的源文件，dist 是通过 gulp 编译过后的文件（稍后会详细说明每一个文件的作用）。</p>

<p><strong>现在请大家思考这样一个问题</strong></p>

<ol>
<li><p>倘若我让线上的网站（不论 PC 还是移动端）使用的 css 文件，JS 文件，images 文件等静态资源，JS 是压缩过的，css 是压缩过的，images（主要针对雪碧图）也是压缩过的，好来减少文件的大小，从而提升一下浏览器的性能，那么应该怎么办？</p></li>

<li><p>如果说我们在项目中使用 LESS，或者 SASS 作为 CSS 的预编译语言（浏览器本身是不支持 LESS，SASS 文件的，难道每次还要使用类似与考拉软件去处理这些吗？）</p></li>

<li><p>如果我想找一个东西帮我去处理上面的这些东西，我写的还是没有压缩的 JS 或者 CSS/less/sass 等，但是在页面上实际上运行（或者等到项目发布的时候替换为压缩过的文件），那么 gulp 就是你很好的选择。</p></li>
</ol>

<p><strong>那么现在这样说大家有没有明白 gulp 是干嘛的吗？不错，它就是来处理上述这些事情的，而且我们在编辑器里修改的代码都是在 src 的目录下，而 dist 文件目录就是经过上述处理过后的文件目录，江湖人称编译过后的文件目录，而 gulp 就是起到了这个桥梁的作用。</strong></p>

<ul>
<li><p>package.json 文件。它就是记录了我们使用了什么插件，以及版本号的记录的一个 json 文件。</p></li>

<li><p>gulpfile.js 文件是大家学习 gulp 的重点。它就是告诉了 gulp 我们要将什么文件编译到什么文件下的 XXX 目录里面。例如在我的 src 目录里面存在一个 css 文件夹，里面装了很多 css 或者 LESS 等样式文件，我现在想通过 gulp 将它编译到 dist 目录下面的 css 文件夹里面并且这个 css 文件夹里的样式文件还是压缩过了。那么 gulpfile.js 就是起到了这样的一个作用。</p></li>
</ul>
</blockquote>

<p>接下来，我们以 fancybox 的源码的为例，简单了解一下 Gulp 的安装和使用。</p>

<h2 id="5-gulp-安装与使用">5. Gulp 安装与使用</h2>

<p>首先，gulp 是基于 node.js 的工具，所以，在安装 Gulp 前我们需要先安装 node.js 和 npm。node.js 的安装大家可以自行谷歌一下怎么安装，这里不细说。</p>

<p>关于 npm，其实它是一个基于 node.js 的包管理工具，说的通俗一点就是，我们可以通过 npm 这个工具去下载我们想要的包，这些包就是我们在后面需要的各种各样的插件（比如压缩 JS 代码的插件，压缩 CSS 代码的插件），这些都是通过 npm 这样一个工具下载到我们的电脑里面的。说白了，npm 就等同 python 里面的 pip。</p>

<p>第二，我们使用 git 先把 fancybox 的 github 源码先 clone 下来。</p>

<pre><code class="language-bash">$ git clone https://github.com/fancyapps/fancybox.git
Cloning into 'fancybox'...
remote: Enumerating objects: 2611, done.
remote: Total 2611 (delta 0), reused 0 (delta 0), pack-reused 2611
Receiving objects: 100% (2611/2611), 2.26 MiB | 359.00 KiB/s, done.
Resolving deltas: 100% (1680/1680), done.
</code></pre>

<p>第三，进入 fancybox 目录，安装 gulp 和其他依赖。</p>

<pre><code class="language-bash">$ cd fancybox
$ ls
bower.json  dist  docs  gulpfile.js  package.json  README.md  src
$ mv dist dist.raw
$ /usr/local/software/node-v6.12.0/bin/npm install
npm WARN deprecated gulp-header@1.8.12: Removed event-stream from gulp-header
npm WARN deprecated gulp-util@3.0.8: gulp-util is deprecated - replace it, following the guidelines at https://medium.com/gulpjs/gulp-util-ca3b1f9f9ac5
npm WARN deprecated minimatch@2.0.10: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated minimatch@0.2.14: Please update to minimatch 3.0.2 or higher to avoid a RegExp DoS issue
npm WARN deprecated graceful-fs@1.2.3: please upgrade to graceful-fs 4 for compatibility with current and future versions of Node.js
npm WARN deprecated natives@1.1.6: This module relies on Node.js's internals and will break at some point. Do not use it, and update to graceful-fs@4.x.
npm WARN deprecated browserslist@1.7.7: Browserslist 2 could fail on reading Browserslist &gt;3.0 config used in other tools.
@fancyapps/fancybox@3.5.7 /home/shenweiyan/fancybox
......
</code></pre>

<p>第四，修改 fancybox 的 <code>src/js/core.js</code> 源码。把该文件中的 <code>hideScrollbar: true</code> 更改为 <code>hideScrollbar: false</code> 。</p>

<pre><code class="language-bash">$ sed -i 's/hideScrollbar: true/hideScrollbar: false/g' src/js/core.js
</code></pre>

<p>第五，回到 fancybox 根目录，执行 fancybox 源码压缩。</p>

<pre><code class="language-bash">$ ls
bower.json  dist.raw  docs  gulpfile.js  node_modules  package.json  README.md  src
$ ./node_modules/gulp/bin/gulp.js
[11:14:32] Using gulpfile ~/fancybox/gulpfile.js
[11:14:32] Starting 'scripts'...
[11:14:32] Starting 'css'...
[11:14:33] Finished 'css' after 624 ms
[11:14:34] Finished 'scripts' after 2.18 s
[11:14:34] Starting 'default'...
[11:14:34] Finished 'default' after 23 μs
</code></pre>

<p><a data-fancybox="gallery" href="https://note.bioitee.com/yuque/0/2019/png/126032/1577330128086-98048d63-8757-483a-a2db-772b46598e98.png#align=left&amp;display=inline&amp;height=381&amp;name=image.png&amp;originHeight=381&amp;originWidth=776&amp;size=45895&amp;status=done&amp;style=none&amp;width=776"><img src="https://note.bioitee.com/yuque/0/2019/png/126032/1577330128086-98048d63-8757-483a-a2db-772b46598e98.png#align=left&amp;display=inline&amp;height=381&amp;name=image.png&amp;originHeight=381&amp;originWidth=776&amp;size=45895&amp;status=done&amp;style=none&amp;width=776" alt=""></a></p>

<p>最后，把编译后的 <code>dist/jquery.fancybox.min.js</code> 文件应用到博客或者其他网站页面，完成最后设置。</p>

<h2 id="6-几点总结">6. 几点总结</h2>

<ul>
<li>正常情况下的 <code>gulp</code> 可以使用 <code>npm install -g gulp</code> 进行全局安装，或者 <code>npm install --save-dev gulp</code> 在当前项目(目录)中安装 <code>gulp</code> 。区别是， <code>-g</code> 参数会把 <code>gulp</code> 安装在 <code>node</code> 默认的 <code>bin</code> 路径下，即全局安装；而不加 <code>-g</code> 参数， 则会把 <code>gulp</code> 默认安装到当前目录的 <code>node_modules/gulp/bin</code> 下。</li>

<li><p><code>--save</code> 会把依赖包名称添加到 <code>package.json</code> 文件 <code>dependencies</code> 键下；而 <code>--save-dev</code> 则添加到 <code>package.json</code> 文件 <code>devDependencies</code> 键下，譬如：</p>

<pre><code class="language-json">{
&quot;dependencies&quot;: {
&quot;vue&quot;: &quot;^2.2.1&quot;
},
&quot;devDependencies&quot;: {
&quot;babel-core&quot;: &quot;^6.0.0&quot;,
&quot;babel-loader&quot;: &quot;^6.0.0&quot;,
&quot;babel-preset-latest&quot;: &quot;^6.0.0&quot;,
&quot;cross-env&quot;: &quot;^3.0.0&quot;,
&quot;css-loader&quot;: &quot;^0.25.0&quot;,
&quot;file-loader&quot;: &quot;^0.9.0&quot;,
&quot;vue-loader&quot;: &quot;^11.1.4&quot;,
&quot;vue-template-compiler&quot;: &quot;^2.2.1&quot;,
&quot;webpack&quot;: &quot;^2.2.0&quot;,
&quot;webpack-dev-server&quot;: &quot;^2.2.0&quot;
}
}
</code></pre></li>

<li><p>它们真正的区别是， <code>npm</code> 自己的文档说 <code>dependencies</code> 是运行时依赖， <code>devDependencies</code> 是开发时的依赖。即 <code>devDependencies</code> 下列出的模块，是我们开发时用的，比如我们安装 js 的压缩包 <code>gulp-uglify</code> 时，我们采用的是 <code>npm install –save-dev gulp-uglify</code> 命令安装，因为我们在发布后用不到它，而只是在我们开发才用到它。 <code>dependencies</code> 下的模块，则是我们发布后还需要依赖的模块，譬如像 jQuery 库或者 Angular 框架类似的，我们在开发完后后肯定还要依赖它们，否则就运行不了。</p></li>

<li><p>对于已经存在 <code>package.json</code> 配置文件(定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据）)的目录，我们可以直接在当前目录执行 <code>npm install</code> 进行安装， <code>npm install</code> 命令根据这个配置文件，自动下载所需的模块，也就是配置项目所需的运行和开发环境。</p></li>
</ul>

<h2 id="7-参考资料">7. 参考资料</h2>

<ul>
<li>panw3i，《<a href="https://www.jianshu.com/p/b1b6e5a94b6a">npm &ndash;save-dev &ndash;save 的区别</a>》，简书</li>
<li>小丑皇，《<a href="https://segmentfault.com/a/1190000007137199">gulp前端构建工具白话讲解，也包含自己使用的一些心得体会</a>》，SegmentFault</li>
<li>十年踪迹的博客，《<a href="https://www.h5jun.com/post/gulp-build">使用Gulp构建网站小白教程</a>》，十年踪迹的博客</li>
<li>bibichuan，《<a href="https://bibichuan.github.io/2019/03/19/fancybox3%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/">fancybox3使用总结</a>》，bibichuan 的底盘 - Github 个人博客</li>
</ul>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">
      
      <a href="../../../topic/tech/2019-12-24-caiyunapp/">一款英文文章阅读翻译精品工具</a>
      <br/>&larr;&nbsp;
      
  </span>
  <span class="nav-next">
      
      <a href="../../../topic/tech/2019-12-30-opodb3/">从 Jupyter Notebook 升级到 JupyterLab</a>
      <br/>&nbsp;&rarr;
      
  </span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/topic\/tech\/2019-12-24-caiyunapp\/';
    
  } else if (e.which == 39) {  
    
    url = '\/topic\/tech\/2019-12-30-opodb3\/';
    
  }
  if (url) window.location = url;
});
</script>



<section class="comments">
<script src="https://utteranc.es/client.js"
        repo="shenweiyan/issues"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</section>




<script async src="../../../js/fix-toc.js"></script>

<script async src="../../../js/center-img.js"></script>

<script async src="../../../js/right-quote.js"></script>

<script async src="../../../js/no-highlight.js"></script>

<script async src="../../../js/fix-footnote.js"></script>

<script async src="../../../js/math-code.js"></script>

<script async src="../../../js/external-link.js"></script>

<script async src="../../../js/alt-title.js"></script>

<script async src="../../../js/header-link.js"></script>

<script async src="../../../js/dom-scripts.js"></script>


<script async src="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>



  
  
  
  

  <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5m6pzaeh5ar&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=0" async="async"></script>
  </footer>
  </article>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  </body>
</html>

